<div class="auth-wrapper auth-v1 px-2">
  <div class="auth-inner py-2">
    <div class="card mb-0">
      <div class="card-body">
        <div class="d-flex justify-content-center">
          <img alt="brand-logo" style="width: 70px;" src="assets/images/logo/logo.png">
        </div>

        <h4 class="card-title mb-1">Xin chào !</h4>
        <p class="card-text mb-2">Đăng nhập để sử dụng các dịch vụ</p>

        <ngb-alert [type]="'danger'" [dismissible]="false" *ngIf="error">
          <div class="alert-body"><p>{{ error }}</p></div>
        </ngb-alert>

        <form class="auth-login-form mt-2" [formGroup]="loginForm" (ngSubmit)="onSubmit()">
          <!-- Số điện thoại + mật khẩu chỉ hiện ở bước đầu -->
          <div *ngIf="!isReceiveOtp">
            <!-- Số điện thoại -->
            <div class="form-group">
              <label class="form-label">Số Điện Thoại</label>
              <input type="tel" formControlName="username" class="form-control" placeholder="Nhập Số Điện Thoại"
                [ngClass]="{ 'is-invalid': submitted && f.username.errors }" />
              <div *ngIf="submitted && f.username.errors" class="invalid-feedback">
                <div *ngIf="f.username.errors.required">Vui lòng nhập số điện thoại</div>
              </div>
            </div>

            <!-- Mật khẩu -->
            <div class="form-group">
              <label class="form-label">Mật khẩu</label>
              <code-input [isCodeHidden]="true" [isCharsCode]="false" [codeLength]="6" (codeCompleted)="onCompletedInputPassword($event)">
              </code-input>
              <div *ngIf="submitted && f.password.errors" class="invalid-feedback d-block">
                <div *ngIf="f.password.errors.required">Vui lòng nhập mật khẩu</div>
                <div *ngIf="f.password.errors.minlength">Mật khẩu tối thiểu 6 ký tự</div>
              </div>
            </div>
          </div>

          <!-- Chỉ hiển thị OTP khi đã gửi -->
          <div class="form-group" *ngIf="isReceiveOtp">
            <label class="form-label">OTP</label>
            <code-input [isCodeHidden]="false" [isCharsCode]="false" [codeLength]="6" (codeCompleted)="onCompletedInputOtp($event)">
            </code-input>
            <div *ngIf="submitted && f.otp.errors" class="invalid-feedback d-block">
              <div *ngIf="f.otp.errors.required">Vui lòng nhập mã OTP</div>
            </div>
          </div>

          <div class="text-right mb-1">
            <a routerLink="/auth/forgot-password"><small>Quên mật khẩu?</small></a>
          </div>

          <button class="btn btn-primary btn-block" type="submit">
            {{ isReceiveOtp ? 'Đăng nhập' : 'Tiếp tục' }}
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
